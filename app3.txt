<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Algebra Equate - Complete Learning Platform</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #1a202c;
      min-height: 100%;
    }

    html {
      min-height: 100%;
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .main-wrapper {
      max-width: 1400px;
      margin: 0 auto;
      min-height: 100%;
      background: #f7fafc;
      box-shadow: 0 0 40px rgba(0,0,0,0.2);
      width: 100%;
    }

    @keyframes slideInRight {
      from { transform: translateX(400px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes slideInLeft {
      from { transform: translateX(-400px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes slideInDown {
      from { transform: translateY(-100px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes scaleIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    @keyframes bounceAnim {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    @keyframes spinAnim {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    @keyframes glowAnim {
      0%, 100% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.5); }
      50% { box-shadow: 0 0 40px rgba(102, 126, 234, 0.8); }
    }

    @keyframes pulseGlow {
      0%, 100% { filter: drop-shadow(0 8px 20px rgba(102, 126, 234, 0.3)); }
      50% { filter: drop-shadow(0 12px 30px rgba(102, 126, 234, 0.6)); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes wiggle {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-5deg); }
      75% { transform: rotate(5deg); }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-15px); }
    }

    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }

    @keyframes slideUp {
      from { transform: translateY(100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes zoomIn {
      from { transform: scale(0); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      10%, 30% { transform: scale(1.1); }
      20%, 40% { transform: scale(1); }
    }

    .welcome-screen {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100%;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      position: relative;
      overflow: hidden;
    }

    .welcome-screen::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: spinAnim 60s linear infinite;
    }

    .welcome-panel {
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(30px);
      border-radius: 40px;
      padding: 64px 56px;
      max-width: 560px;
      width: 100%;
      box-shadow: 0 30px 90px rgba(0,0,0,0.3);
      position: relative;
      z-index: 1;
      border: 3px solid rgba(255, 255, 255, 0.7);
      animation: fadeInUp 0.6s ease-out;
    }

    @media (max-width: 768px) {
      .welcome-panel {
        padding: 32px 24px;
        border-radius: 24px;
      }
    }

    .welcome-title-section {
      text-align: center;
      margin-bottom: 40px;
    }

    .main-logo {
      width: 140px;
      height: 140px;
      margin: 0 auto 24px;
      filter: drop-shadow(0 8px 30px rgba(102, 126, 234, 0.4));
      animation: bounceAnim 2s infinite;
    }

    .welcome-title-section h1 {
      margin: 0 0 12px 0;
      font-size: 42px;
      font-weight: 900;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -1px;
    }

    .welcome-title-section p {
      margin: 0;
      color: #64748b;
      font-size: 17px;
      font-weight: 700;
    }

    .role-title {
      text-align: center;
      margin-bottom: 20px;
      font-size: 15px;
      font-weight: 800;
      color: #1a202c;
    }

    .role-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px;
      margin-bottom: 36px;
    }

    .role-option {
      padding: 28px 16px;
      border: 3px solid rgba(226, 232, 240, 0.7);
      border-radius: 24px;
      background: white;
      cursor: pointer;
      text-align: center;
      transition: all 0.3s;
      touch-action: manipulation;
    }

    @media (max-width: 768px) {
      .role-options {
        gap: 10px;
      }
      .role-option {
        padding: 20px 12px;
      }
    }

    .role-option:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);
    }

    .role-option.active {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(240, 147, 251, 0.15));
      transform: scale(1.05);
    }

    .role-label {
      font-weight: 800;
      font-size: 15px;
      color: #1a202c;
    }

    .section-divider {
      display: flex;
      align-items: center;
      margin: 32px 0;
      color: #94a3b8;
      font-size: 13px;
      font-weight: 800;
    }

    .section-divider::before,
    .section-divider::after {
      content: '';
      flex: 1;
      height: 2px;
      background: linear-gradient(90deg, transparent, #cbd5e0, transparent);
    }

    .section-divider::before {
      margin-right: 16px;
    }

    .section-divider::after {
      margin-left: 16px;
    }

    .auth-methods {
      display: grid;
      gap: 14px;
    }

    .auth-button {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 22px 28px;
      border: 3px solid rgba(226, 232, 240, 0.9);
      border-radius: 18px;
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      cursor: pointer;
      font-family: inherit;
      font-weight: 800;
      font-size: 17px;
      transition: all 0.3s;
      color: #1a202c;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      position: relative;
      overflow: hidden;
      min-height: 60px;
      touch-action: manipulation;
    }

    @media (max-width: 768px) {
      .auth-button {
        padding: 18px 20px;
        font-size: 15px;
        gap: 16px;
      }
    }

    .auth-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
      transition: left 0.5s;
    }

    .auth-button:hover::before {
      left: 100%;
    }

    .auth-button:hover {
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.25);
    }

    .auth-icon {
      width: 36px;
      height: 36px;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      font-weight: 900;
      flex-shrink: 0;
    }

    .welcome-footer {
      text-align: center;
      margin-top: 32px;
      padding-top: 24px;
      border-top: 2px solid #e2e8f0;
      font-size: 13px;
      color: #64748b;
    }

    .top-bar {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 16px;
      animation: slideInDown 0.5s ease-out;
    }

    .top-bar-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .top-bar-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .profile-circle {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: rgba(255,255,255,0.25);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      font-weight: 700;
      transition: all 0.3s;
      animation: zoomIn 0.6s ease-out;
    }
    
    .profile-circle:hover {
      animation: pulse 1s infinite;
    }

    .profile-details h2 {
      margin: 0;
      font-size: 20px;
      font-weight: 800;
    }

    .profile-details p {
      margin: 4px 0 0 0;
      font-size: 14px;
    }

    @media (max-width: 768px) {
      .profile-circle {
        width: 44px;
        height: 44px;
        font-size: 20px;
      }
      .profile-details h2 {
        font-size: 16px;
      }
      .profile-details p {
        font-size: 12px;
      }
    }

    .top-bar-right {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .info-badge {
      background: rgba(255,255,255,0.2);
      padding: 10px 18px;
      border-radius: 20px;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 6px;
      touch-action: manipulation;
      min-height: 40px;
      animation: fadeIn 0.8s ease-out;
    }

    .info-badge:hover {
      background: rgba(255,255,255,0.3);
      transform: scale(1.05);
      animation: wiggle 0.5s ease-in-out;
    }

    @media (max-width: 768px) {
      .info-badge {
        padding: 8px 10px;
        font-size: 11px;
      }
    }

    .navigation-bar {
      display: flex;
      background: white;
      border-bottom: 2px solid #e2e8f0;
      overflow-x: auto;
      scrollbar-width: none;
      animation: slideInLeft 0.7s ease-out;
    }

    .navigation-bar::-webkit-scrollbar {
      display: none;
    }

    .nav-item {
      flex: 1;
      min-width: 100px;
      padding: 16px 8px;
      background: none;
      border: none;
      cursor: pointer;
      font-weight: 700;
      font-family: inherit;
      font-size: 14px;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
      white-space: nowrap;
      touch-action: manipulation;
      animation: fadeInUp 0.8s ease-out backwards;
    }
    
    .nav-item:nth-child(1) { animation-delay: 0.1s; }
    .nav-item:nth-child(2) { animation-delay: 0.2s; }
    .nav-item:nth-child(3) { animation-delay: 0.3s; }
    .nav-item:nth-child(4) { animation-delay: 0.4s; }
    .nav-item:nth-child(5) { animation-delay: 0.5s; }
    .nav-item:nth-child(6) { animation-delay: 0.6s; }

    @media (max-width: 768px) {
      .nav-item {
        font-size: 12px;
        padding: 14px 6px;
        min-width: 80px;
      }
    }

    .nav-item.current {
      color: #667eea;
      border-bottom-color: #667eea;
      background: rgba(102, 126, 234, 0.05);
    }

    .nav-item:hover {
      background: rgba(102, 126, 234, 0.05);
    }

    .main-content {
      padding: 24px;
      animation: fadeIn 0.6s ease-out;
    }

    @media (max-width: 768px) {
      .main-content {
        padding: 16px;
      }
    }

    .content-section {
      display: none;
    }

    .content-section.showing {
      display: block;
      animation: fadeInUp 0.5s ease-out;
    }
    
    .content-section h2 {
      animation: slideInLeft 0.6s ease-out;
    }
    
    .content-section > p {
      animation: fadeInUp 0.7s ease-out;
    }

    .level-logo {
      animation: pulseGlow 3s infinite ease-in-out;
    }

    .level-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 24px;
      margin-top: 24px;
    }

    @media (max-width: 768px) {
      .level-grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }

    .level-item {
      background: white;
      border-radius: 20px;
      padding: 32px 28px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      cursor: pointer;
      border: 3px solid #e2e8f0;
      text-align: center;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
      animation: scaleIn 0.5s ease-out backwards;
    }
    
    .level-item:nth-child(1) { animation-delay: 0.1s; }
    .level-item:nth-child(2) { animation-delay: 0.15s; }
    .level-item:nth-child(3) { animation-delay: 0.2s; }
    .level-item:nth-child(4) { animation-delay: 0.25s; }
    .level-item:nth-child(5) { animation-delay: 0.3s; }
    .level-item:nth-child(6) { animation-delay: 0.35s; }
    .level-item:nth-child(7) { animation-delay: 0.4s; }
    .level-item:nth-child(8) { animation-delay: 0.45s; }

    .level-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .level-item:hover::before {
      left: 100%;
    }

    .level-item:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 16px 40px rgba(102, 126, 234, 0.35);
      border-color: #667eea;
      animation: float 2s ease-in-out infinite;
    }

    .level-item.disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .level-item.disabled:hover {
      transform: none;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .level-title {
      font-size: 24px;
      font-weight: 800;
      margin-bottom: 8px;
    }

    @media (max-width: 768px) {
      .level-title {
        font-size: 20px;
      }
    }

    .level-desc {
      font-size: 14px;
      color: #64748b;
      margin-bottom: 16px;
    }

    .action-btn {
      padding: 14px 28px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.3s;
      min-height: 48px;
      touch-action: manipulation;
      position: relative;
      overflow: hidden;
    }
    
    .action-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .action-btn:active::after {
      width: 300px;
      height: 300px;
    }

    .action-btn:hover {
      transform: scale(1.05) translateY(-2px);
      animation: pulse 0.6s ease-in-out;
    }

    .btn-main {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }
    
    .btn-main:hover {
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.5);
    }

    .btn-alt {
      background: #e2e8f0;
      color: #1a202c;
    }
    
    .btn-alt:hover {
      background: #cbd5e0;
    }

    .hide-element {
      display: none !important;
    }

    .notification-toast {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 18px 28px;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
      z-index: 2000;
      font-weight: 700;
      color: white;
      animation: slideInRight 0.3s ease-out;
    }

    .toast-success-style {
      background: linear-gradient(135deg, #48bb78, #38a169);
    }

    .toast-info-style {
      background: linear-gradient(135deg, #667eea, #764ba2);
    }

    .toast-warn-style {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
    }

    .progress-track {
      background: #e2e8f0;
      height: 10px;
      border-radius: 5px;
      overflow: hidden;
      margin-top: 16px;
      position: relative;
    }
    
    .progress-track::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      animation: shimmer 2s infinite;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      transition: width 0.8s;
      position: relative;
      animation: slideInLeft 1s ease-out;
    }
    
    .progress-fill::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: shimmer 1.5s infinite;
    }

    .game-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 24px;
      margin-top: 24px;
    }

    @media (max-width: 768px) {
      .game-grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }

    .game-item {
      background: white;
      border-radius: 20px;
      padding: 28px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      cursor: pointer;
      border: 3px solid #e2e8f0;
      text-align: center;
      transition: all 0.3s;
      touch-action: manipulation;
      animation: fadeInUp 0.6s ease-out backwards;
    }
    
    .game-item:nth-child(1) { animation-delay: 0.1s; }
    .game-item:nth-child(2) { animation-delay: 0.2s; }
    .game-item:nth-child(3) { animation-delay: 0.3s; }

    .game-item:hover {
      transform: translateY(-8px);
      box-shadow: 0 16px 40px rgba(102, 126, 234, 0.35);
      border-color: #667eea;
      animation: pulse 1s ease-in-out infinite;
    }

    .game-emoji {
      font-size: 80px;
      margin-bottom: 16px;
      transition: transform 0.3s;
      animation: bounceAnim 2s ease-in-out infinite;
    }

    .game-item:hover .game-emoji {
      transform: scale(1.2) rotate(10deg);
      animation: wiggle 0.5s ease-in-out infinite;
    }

    .game-title {
      font-size: 24px;
      font-weight: 800;
      margin-bottom: 12px;
    }

    .game-description {
      font-size: 14px;
      color: #64748b;
      line-height: 1.6;
      margin-bottom: 16px;
    }

    .store-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }

    @media (max-width: 768px) {
      .store-grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }

    .store-product {
      background: white;
      border-radius: 16px;
      padding: 24px;
      border: 2px solid #e2e8f0;
      transition: all 0.3s;
      animation: slideUp 0.5s ease-out backwards;
    }
    
    .store-product:nth-child(1) { animation-delay: 0.05s; }
    .store-product:nth-child(2) { animation-delay: 0.1s; }
    .store-product:nth-child(3) { animation-delay: 0.15s; }
    .store-product:nth-child(4) { animation-delay: 0.2s; }
    .store-product:nth-child(5) { animation-delay: 0.25s; }
    .store-product:nth-child(6) { animation-delay: 0.3s; }

    .store-product:hover {
      transform: translateY(-8px);
      border-color: #667eea;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);
    }

    .product-emoji {
      font-size: 48px;
      margin-bottom: 12px;
      animation: float 3s ease-in-out infinite;
    }
    
    .store-product:hover .product-emoji {
      animation: heartbeat 1s ease-in-out infinite;
    }

    .product-name {
      font-size: 18px;
      font-weight: 800;
      margin-bottom: 8px;
    }

    .product-info {
      font-size: 14px;
      color: #64748b;
      margin-bottom: 16px;
      min-height: 40px;
    }

    .product-purchase {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .product-cost {
      font-size: 20px;
      font-weight: 800;
      color: #667eea;
    }

    .purchase-btn {
      padding: 10px 20px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      font-family: inherit;
      position: relative;
      overflow: hidden;
    }
    
    .purchase-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .purchase-btn:active::before {
      width: 200px;
      height: 200px;
    }

    .purchase-btn:hover {
      transform: scale(1.1) rotate(2deg);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      animation: wiggle 0.4s ease-in-out;
    }

    .purchase-btn:disabled {
      background: #94a3b8;
      cursor: not-allowed;
      opacity: 0.7;
    }
    
    .purchase-btn:disabled:hover {
      transform: none;
      animation: none;
    }

    .trophy-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 24px;
    }

    @media (max-width: 768px) {
      .trophy-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 12px;
      }
    }

    .trophy-item {
      background: white;
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 2px solid #e2e8f0;
      transition: all 0.3s;
      position: relative;
      animation: zoomIn 0.6s ease-out backwards;
    }
    
    .trophy-item:nth-child(1) { animation-delay: 0.1s; }
    .trophy-item:nth-child(2) { animation-delay: 0.15s; }
    .trophy-item:nth-child(3) { animation-delay: 0.2s; }
    .trophy-item:nth-child(4) { animation-delay: 0.25s; }
    .trophy-item:nth-child(5) { animation-delay: 0.3s; }
    .trophy-item:nth-child(6) { animation-delay: 0.35s; }
    
    .trophy-item:hover {
      transform: scale(1.05);
    }

    .trophy-item.earned {
      border-color: #fbbf24;
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.1));
      animation: glowAnim 2s infinite;
    }
    
    .trophy-item.earned:hover {
      animation: pulse 0.8s ease-in-out infinite;
    }

    .trophy-item.unearned {
      opacity: 0.5;
      filter: grayscale(100%);
    }

    .trophy-emoji {
      font-size: 20px;
      margin-bottom: 12px;
      font-weight: 900;
      color: #667eea;
      background: rgba(102, 126, 234, 0.1);
      padding: 16px;
      border-radius: 12px;
      animation: float 4s ease-in-out infinite;
    }
    
    .trophy-item.earned .trophy-emoji {
      animation: bounceAnim 2s ease-in-out infinite;
    }

    .trophy-name {
      font-size: 16px;
      font-weight: 800;
      margin-bottom: 8px;
    }

    .trophy-details {
      font-size: 13px;
      color: #64748b;
    }

    .category-tabs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 16px;
      margin-bottom: 32px;
    }

    @media (max-width: 768px) {
      .category-tabs {
        grid-template-columns: 1fr;
        gap: 12px;
      }
    }

    .category-tab {
      padding: 16px;
      border: 3px solid #e2e8f0;
      border-radius: 16px;
      background: white;
      cursor: pointer;
      font-family: inherit;
      font-weight: 700;
      transition: all 0.3s;
      text-align: center;
      font-size: 14px;
      touch-action: manipulation;
    }

    .category-tab:hover {
      border-color: #667eea;
      transform: translateY(-2px);
    }

    .category-tab.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      color: #667eea;
    }

    .xp-progress-container {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      height: 8px;
      overflow: hidden;
      margin-top: 8px;
      position: relative;
    }
    
    .xp-progress-container::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: shimmer 2s infinite;
    }

    .xp-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #fbbf24, #f59e0b);
      transition: width 0.5s;
      position: relative;
      box-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
      animation: pulse 2s ease-in-out infinite;
    }

    .bottom-footer {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 32px 24px;
      text-align: center;
      margin-top: 40px;
    }

    .bottom-footer p {
      margin: 8px 0;
      font-size: 14px;
    }

    @media (max-width: 768px) {
      .bottom-footer {
        padding: 24px 16px;
        margin-top: 24px;
      }
    }

    .bottom-footer a {
      color: white;
      text-decoration: underline;
      font-weight: 700;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div id="auth-screen" class="welcome-screen">
   <div class="welcome-panel">
    <div class="welcome-title-section">
     <svg class="main-logo" viewbox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><defs>
       <lineargradient id="logoGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
        <stop offset="50%" style="stop-color:#764ba2;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#f093fb;stop-opacity:1" />
       </lineargradient>
       <lineargradient id="logoGrad2" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#f59e0b;stop-opacity:1" />
       </lineargradient>
       <filter id="glow">
        <fegaussianblur stddeviation="3" result="coloredBlur" />
        <femerge>
         <femergenode in="coloredBlur" />
         <femergenode in="SourceGraphic" />
        </femerge>
       </filter>
      </defs> <!-- Outer rings --> <circle cx="100" cy="100" r="90" fill="none" stroke="url(#logoGrad1)" stroke-width="3" opacity="0.2" /> <circle cx="100" cy="100" r="80" fill="none" stroke="url(#logoGrad1)" stroke-width="2" opacity="0.3" /> <!-- Main shield background --> <path d="M 100,20 L 160,45 L 160,100 Q 160,145 100,175 Q 40,145 40,100 L 40,45 Z" fill="url(#logoGrad1)" opacity="0.95" filter="url(#glow)" /> <!-- Inner shield accent --> <path d="M 100,35 L 145,55 L 145,100 Q 145,135 100,160 Q 55,135 55,100 L 55,55 Z" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.3)" stroke-width="2" /> <!-- Mathematical symbols with enhanced styling --> <g filter="url(#glow)"><!-- X squared -->
       <text x="100" y="75" font-size="32" font-weight="900" fill="#ffffff" text-anchor="middle" font-family="Arial, sans-serif">
        x¬≤
       </text> <!-- Equals sign with decorative style -->
       <line x1="75" y1="95" x2="125" y2="95" stroke="#fbbf24" stroke-width="4" stroke-linecap="round" />
       <line x1="75" y1="105" x2="125" y2="105" stroke="#fbbf24" stroke-width="4" stroke-linecap="round" /> <!-- Y plus Z -->
       <text x="100" y="135" font-size="28" font-weight="900" fill="#ffffff" text-anchor="middle" font-family="Arial, sans-serif">
        y+z
       </text>
      </g> <!-- Corner accent dots --> <circle cx="70" cy="60" r="3" fill="url(#logoGrad2)" opacity="0.8" /> <circle cx="130" cy="60" r="3" fill="url(#logoGrad2)" opacity="0.8" /> <circle cx="60" cy="140" r="3" fill="url(#logoGrad2)" opacity="0.8" /> <circle cx="140" cy="140" r="3" fill="url(#logoGrad2)" opacity="0.8" /> <!-- Top crown accent --> <path d="M 90,28 L 100,20 L 110,28" fill="none" stroke="url(#logoGrad2)" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
     </svg>
     <h1>Algebra Equate</h1>
     <p>Master Algebra with Gamified Learning</p>
    </div>
    <div class="role-title">
     Choose Your Role
    </div>
    <div class="role-options">
     <div class="role-option active" data-role="student">
      <div style="font-size: 60px; display: flex; align-items: center; justify-content: center; height: 60px;">
       üë®‚Äçüéì
      </div>
      <div class="role-label">
       Student
      </div>
     </div>
     <div class="role-option" data-role="teacher">
      <div style="font-size: 60px; display: flex; align-items: center; justify-content: center; height: 60px;">
       üë©‚Äçüè´
      </div>
      <div class="role-label">
       Teacher
      </div>
     </div>
    </div>
    <div class="section-divider">
     LOGIN METHOD
    </div>
    <div class="auth-methods"><button class="auth-button" onclick="performLogin('google')">
      <svg class="auth-icon" viewbox="0 0 48 48" style="background: white; padding: 2px;"><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z" /> <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z" /> <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z" /> <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z" />
      </svg>
      <div>
       Continue with Google
      </div></button> <button class="auth-button" onclick="performLogin('microsoft')">
      <svg class="auth-icon" viewbox="0 0 48 48" style="background: white; padding: 2px;"><rect x="6" y="6" width="18" height="18" fill="#f25022" /> <rect x="26" y="6" width="18" height="18" fill="#00a4ef" /> <rect x="6" y="26" width="18" height="18" fill="#ffb900" /> <rect x="26" y="26" width="18" height="18" fill="#7fba00" />
      </svg>
      <div>
       Continue with Microsoft
      </div></button>
    </div>
    <div class="welcome-footer">
     By continuing, you agree to our Terms &amp; Privacy
    </div>
   </div>
  </div>
  <div id="dashboard-app" class="main-wrapper hide-element">
   <header class="top-bar">
    <div class="top-bar-content">
     <div class="top-bar-left">
      <div class="profile-circle" id="profile-avatar">
       U
      </div>
      <div class="profile-details">
       <h2 id="profile-name">User</h2>
       <p id="profile-role-level">Student ‚Ä¢ Level 1</p>
       <div class="xp-progress-container" style="width: 200px;">
        <div class="xp-progress-bar" id="xp-progress" style="width: 0%"></div>
       </div>
      </div>
     </div>
     <div class="top-bar-right">
      <div class="info-badge"><span style="font-weight: 900;">XP:</span> <span id="xp-display">0 XP</span>
      </div>
      <div class="info-badge"><span style="font-weight: 900;">COINS:</span> <span id="coins-display">100</span>
      </div>
      <div class="info-badge"><span style="font-weight: 900;">STREAK:</span> <span id="streak-display">0</span>
      </div><button class="info-badge" onclick="performLogout()" style="border: none; background: rgba(255,255,255,0.2);"> <span style="font-weight: 900;">EXIT</span> </button>
     </div>
    </div>
   </header>
   <nav class="navigation-bar" id="student-navigation"><button class="nav-item current" onclick="navigateTo('levels')">LEVELS</button> <button class="nav-item" onclick="navigateTo('games')">GAMES</button> <button class="nav-item" onclick="navigateTo('challenges')">CHALLENGES</button> <button class="nav-item" onclick="navigateTo('shop')">SHOP</button> <button class="nav-item" onclick="navigateTo('achievements')">ACHIEVEMENTS</button> <button class="nav-item" onclick="navigateTo('account')">ACCOUNT</button>
   </nav>
   <nav class="navigation-bar hide-element" id="teacher-navigation"><button class="nav-item current" onclick="navigateTo('teacher-dashboard')">DASHBOARD</button> <button class="nav-item" onclick="navigateTo('teacher-students')">STUDENTS</button> <button class="nav-item" onclick="navigateTo('teacher-assignments')">ASSIGNMENTS</button> <button class="nav-item" onclick="navigateTo('account')">ACCOUNT</button>
   </nav>
   <main class="main-content"><!-- Account Settings -->
    <div id="account-section" class="content-section">
     <h2 style="font-size: 32px; font-weight: 900;">‚öôÔ∏è Account Settings</h2>
     <p style="color: #64748b; margin-bottom: 24px;">Manage your account information and preferences</p>
     <div style="display: grid; gap: 24px; max-width: 800px;">
      <div style="background: white; padding: 32px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
       <h3 style="margin-top: 0; font-size: 20px; font-weight: 900;">üë§ Profile Information</h3>
       <div style="display: grid; gap: 16px;">
        <div><label for="settings-name" style="display: block; font-weight: 700; margin-bottom: 8px; color: #1a202c;">Name</label> <input type="text" id="settings-name" value="User" style="width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit;">
        </div>
        <div><label for="settings-email" style="display: block; font-weight: 700; margin-bottom: 8px; color: #1a202c;">Email</label> <input type="email" id="settings-email" value="user@example.com" style="width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit;">
        </div>
        <div><label for="settings-role" style="display: block; font-weight: 700; margin-bottom: 8px; color: #1a202c;">Role</label> <input type="text" id="settings-role" readonly style="width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit; background: #f7fafc; color: #64748b;">
        </div>
       </div><button class="action-btn btn-main" onclick="saveProfileSettings()" style="margin-top: 20px;">Save Changes</button>
      </div>
      <div style="background: white; padding: 32px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
       <h3 style="margin-top: 0; font-size: 20px; font-weight: 900;">üé® Avatar Color</h3>
       <div style="display: flex; gap: 16px; flex-wrap: wrap;">
        <div onclick="updateAvatarColor('#667eea')" style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); cursor: pointer; border: 4px solid #e2e8f0; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></div>
        <div onclick="updateAvatarColor('#48bb78')" style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #48bb78, #38a169); cursor: pointer; border: 4px solid #e2e8f0; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></div>
        <div onclick="updateAvatarColor('#f56565')" style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #f56565, #e53e3e); cursor: pointer; border: 4px solid #e2e8f0; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></div>
        <div onclick="updateAvatarColor('#fbbf24')" style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #fbbf24, #f59e0b); cursor: pointer; border: 4px solid #e2e8f0; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></div>
        <div onclick="updateAvatarColor('#a855f7')" style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #a855f7, #9333ea); cursor: pointer; border: 4px solid #e2e8f0; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></div>
       </div>
      </div>
     </div>
    </div><!-- Student: Levels -->
    <div id="levels-section" class="content-section showing">
     <div style="text-align: center; margin-bottom: 40px;">
      <svg class="level-logo" viewbox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" style="width: 110px; height: 110px; margin: 0 auto 24px;"><defs>
        <lineargradient id="levelLogoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
         <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
         <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
        </lineargradient>
        <lineargradient id="starGrad" x1="0%" y1="0%" x2="100%" y2="100%">
         <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />
         <stop offset="100%" style="stop-color:#f59e0b;stop-opacity:1" />
        </lineargradient>
        <filter id="levelGlow">
         <fegaussianblur stddeviation="2" result="coloredBlur" />
         <femerge>
          <femergenode in="coloredBlur" />
          <femergenode in="SourceGraphic" />
         </femerge>
        </filter>
       </defs> <!-- Outer glow circle --> <circle cx="100" cy="100" r="85" fill="none" stroke="url(#levelLogoGrad)" stroke-width="2" opacity="0.2" /> <!-- Main target circle --> <circle cx="100" cy="100" r="75" fill="url(#levelLogoGrad)" opacity="0.12" filter="url(#levelGlow)" /> <circle cx="100" cy="100" r="75" fill="none" stroke="url(#levelLogoGrad)" stroke-width="5" /> <!-- Inner circles --> <circle cx="100" cy="100" r="55" fill="none" stroke="url(#levelLogoGrad)" stroke-width="4" opacity="0.7" /> <circle cx="100" cy="100" r="35" fill="none" stroke="url(#levelLogoGrad)" stroke-width="4" opacity="0.9" /> <!-- Center target dot --> <circle cx="100" cy="100" r="20" fill="url(#levelLogoGrad)" filter="url(#levelGlow)" /> <circle cx="100" cy="100" r="14" fill="white" /> <circle cx="100" cy="100" r="8" fill="url(#starGrad)" /> <!-- Crosshair lines --> <line x1="100" y1="18" x2="100" y2="42" stroke="url(#levelLogoGrad)" stroke-width="4" stroke-linecap="round" /> <line x1="100" y1="158" x2="100" y2="182" stroke="url(#levelLogoGrad)" stroke-width="4" stroke-linecap="round" /> <line x1="18" y1="100" x2="42" y2="100" stroke="url(#levelLogoGrad)" stroke-width="4" stroke-linecap="round" /> <line x1="158" y1="100" x2="182" y2="100" stroke="url(#levelLogoGrad)" stroke-width="4" stroke-linecap="round" /> <!-- Corner accent marks --> <path d="M 42 42 L 54 42 L 54 54" fill="none" stroke="url(#starGrad)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" opacity="0.9" /> <path d="M 158 42 L 146 42 L 146 54" fill="none" stroke="url(#starGrad)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" opacity="0.9" /> <path d="M 42 158 L 54 158 L 54 146" fill="none" stroke="url(#starGrad)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" opacity="0.9" /> <path d="M 158 158 L 146 158 L 146 146" fill="none" stroke="url(#starGrad)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" opacity="0.9" /> <!-- Decorative diagonal lines --> <line x1="138" y1="62" x2="148" y2="52" stroke="url(#levelLogoGrad)" stroke-width="2.5" stroke-linecap="round" opacity="0.5" /> <line x1="62" y1="62" x2="52" y2="52" stroke="url(#levelLogoGrad)" stroke-width="2.5" stroke-linecap="round" opacity="0.5" /> <line x1="138" y1="138" x2="148" y2="148" stroke="url(#levelLogoGrad)" stroke-width="2.5" stroke-linecap="round" opacity="0.5" /> <line x1="62" y1="138" x2="52" y2="148" stroke="url(#levelLogoGrad)" stroke-width="2.5" stroke-linecap="round" opacity="0.5" />
      </svg>
      <h2 style="font-size: clamp(28px, 5vw, 38px); font-weight: 900; margin: 0 0 14px 0; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; letter-spacing: -0.5px;">Choose Your Level</h2>
      <p style="color: #64748b; margin: 0; font-size: clamp(14px, 3vw, 18px); font-weight: 600; line-height: 1.6;">Practice and master algebra concepts at your own pace</p>
     </div>
     <div class="level-grid" id="level-container"></div>
    </div><!-- Student: Games -->
    <div id="games-section" class="content-section">
     <h2 style="font-size: 32px; font-weight: 900;">ÔøΩÔøΩÔ∏è Educational Games</h2>
     <p style="color: #64748b; margin-bottom: 24px;">Learn algebra through fun and interactive games!</p>
     <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
      <div style="background: white; padding: 24px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
       <div style="font-size: 40px; margin-bottom: 12px;">
        üéà
       </div>
       <div style="font-size: 32px; font-weight: 900; color: #667eea; margin-bottom: 8px;" id="balloon-record">
        0
       </div>
       <div style="font-size: 14px; color: #64748b; font-weight: 600;">
        Balloon Pop Record
       </div>
      </div>
      <div style="background: white; padding: 24px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
       <div style="font-size: 40px; margin-bottom: 12px;">
        üåÄ
       </div>
       <div style="font-size: 32px; font-weight: 900; color: #667eea; margin-bottom: 8px;" id="maze-record">
        0
       </div>
       <div style="font-size: 14px; color: #64748b; font-weight: 600;">
        Maze Record
       </div>
      </div>
      <div style="background: white; padding: 24px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
       <div style="font-size: 40px; margin-bottom: 12px;">
        ‚ö°
       </div>
       <div style="font-size: 32px; font-weight: 900; color: #667eea; margin-bottom: 8px;" id="speed-record">
        0
       </div>
       <div style="font-size: 14px; color: #64748b; font-weight: 600;">
        Speed Solve Record
       </div>
      </div>
     </div>
     <div class="game-grid" id="game-container"></div>
    </div><!-- Student: Challenges -->
    <div id="challenges-section" class="content-section">
     <h2 style="font-size: 32px; font-weight: 900;">üèÜ Daily Challenges</h2>
     <p style="color: #64748b; margin-bottom: 24px;">Complete daily challenges for bonus rewards!</p>
     <div style="display: grid; gap: 20px;">
      <div style="background: white; padding: 28px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-left: 6px solid #48bb78;">
       <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
        <div>
         <h3 style="margin: 0 0 8px 0; font-size: 22px; font-weight: 900;">üî• Answer 20 Questions</h3>
         <p style="margin: 0; color: #64748b; font-size: 15px;">Practice makes perfect!</p>
        </div>
        <div style="background: rgba(72, 187, 120, 0.15); color: #38a169; padding: 8px 20px; border-radius: 20px; font-weight: 800; font-size: 14px;">
         +100 Coins +50 XP
        </div>
       </div>
       <div style="background: #e2e8f0; height: 12px; border-radius: 6px; overflow: hidden;">
        <div id="challenge1-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #48bb78, #38a169); transition: width 0.8s;"></div>
       </div>
       <div style="margin-top: 8px; font-size: 14px; font-weight: 700; color: #64748b;" id="challenge1-text">
        0/20 completed
       </div>
      </div>
      <div style="background: white; padding: 28px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-left: 6px solid #667eea;">
       <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
        <div>
         <h3 style="margin: 0 0 8px 0; font-size: 22px; font-weight: 900;">üéØ Get 5 in a Row Correct</h3>
         <p style="margin: 0; color: #64748b; font-size: 15px;">Show your consistency!</p>
        </div>
        <div style="background: rgba(102, 126, 234, 0.15); color: #667eea; padding: 8px 20px; border-radius: 20px; font-weight: 800; font-size: 14px;">
         +150 Coins +75 XP
        </div>
       </div>
       <div style="background: #e2e8f0; height: 12px; border-radius: 6px; overflow: hidden;">
        <div id="challenge2-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); transition: width 0.8s;"></div>
       </div>
       <div style="margin-top: 8px; font-size: 14px; font-weight: 700; color: #64748b;" id="challenge2-text">
        0/5 completed
       </div>
      </div>
      <div style="background: white; padding: 28px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-left: 6px solid #a855f7;">
       <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
        <div>
         <h3 style="margin: 0 0 8px 0; font-size: 22px; font-weight: 900;">‚ö° Speed Demon</h3>
         <p style="margin: 0; color: #64748b; font-size: 15px;">Answer 10 questions in under 2 minutes</p>
        </div>
        <div style="background: rgba(168, 85, 247, 0.15); color: #9333ea; padding: 8px 20px; border-radius: 20px; font-weight: 800; font-size: 14px;">
         +200 Coins +100 XP
        </div>
       </div>
       <div style="background: #e2e8f0; height: 12px; border-radius: 6px; overflow: hidden;">
        <div id="challenge3-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #a855f7, #9333ea); transition: width 0.8s;"></div>
       </div>
       <div style="margin-top: 8px; font-size: 14px; font-weight: 700; color: #64748b;" id="challenge3-text">
        Not completed
       </div>
      </div>
      <div style="background: white; padding: 28px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-left: 6px solid #f59e0b;">
       <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
        <div>
         <h3 style="margin: 0 0 8px 0; font-size: 22px; font-weight: 900;">üíØ Perfect Score</h3>
         <p style="margin: 0; color: #64748b; font-size: 15px;">Get 100% accuracy on any level</p>
        </div>
        <div style="background: rgba(245, 158, 11, 0.15); color: #d97706; padding: 8px 20px; border-radius: 20px; font-weight: 800; font-size: 14px;">
         +250 Coins +125 XP
        </div>
       </div>
       <div style="background: #e2e8f0; height: 12px; border-radius: 6px; overflow: hidden;">
        <div id="challenge4-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #fbbf24, #f59e0b); transition: width 0.8s;"></div>
       </div>
       <div style="margin-top: 8px; font-size: 14px; font-weight: 700; color: #64748b;" id="challenge4-text">
        Not completed
       </div>
      </div>
      <div style="background: white; padding: 28px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-left: 6px solid #ef4444;">
       <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
        <div>
         <h3 style="margin: 0 0 8px 0; font-size: 22px; font-weight: 900;">üéÆ Game Master</h3>
         <p style="margin: 0; color: #64748b; font-size: 15px;">Score 100+ points in any game</p>
        </div>
        <div style="background: rgba(239, 68, 68, 0.15); color: #dc2626; padding: 8px 20px; border-radius: 20px; font-weight: 800; font-size: 14px;">
         +175 Coins +85 XP
        </div>
       </div>
       <div style="background: #e2e8f0; height: 12px; border-radius: 6px; overflow: hidden;">
        <div id="challenge5-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #ef4444, #dc2626); transition: width 0.8s;"></div>
       </div>
       <div style="margin-top: 8px; font-size: 14px; font-weight: 700; color: #64748b;" id="challenge5-text">
        Not completed
       </div>
      </div>
      <div style="background: white; padding: 28px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-left: 6px solid #14b8a6;">
       <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
        <div>
         <h3 style="margin: 0 0 8px 0; font-size: 22px; font-weight: 900;">üìö Study Session</h3>
         <p style="margin: 0; color: #64748b; font-size: 15px;">Practice for 30 minutes total</p>
        </div>
        <div style="background: rgba(20, 184, 166, 0.15); color: #0d9488; padding: 8px 20px; border-radius: 20px; font-weight: 800; font-size: 14px;">
         +120 Coins +60 XP
        </div>
       </div>
       <div style="background: #e2e8f0; height: 12px; border-radius: 6px; overflow: hidden;">
        <div id="challenge6-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #14b8a6, #0d9488); transition: width 0.8s;"></div>
       </div>
       <div style="margin-top: 8px; font-size: 14px; font-weight: 700; color: #64748b;" id="challenge6-text">
        0/30 minutes
       </div>
      </div>
     </div>
    </div><!-- Student: Shop -->
    <div id="shop-section" class="content-section">
     <h2 style="font-size: 32px; font-weight: 900;">üõí Item Shop</h2>
     <p style="color: #64748b; margin-bottom: 24px;">Spend your hard-earned coins on power-ups and upgrades</p>
     <div class="category-tabs"><button class="category-tab selected" onclick="filterStore('all')">üè¨ All Items</button> <button class="category-tab" onclick="filterStore('general')">üéÅ General</button> <button class="category-tab" onclick="filterStore('upgrades')">‚ö° Upgrades</button> <button class="category-tab" onclick="filterStore('cosmetics')">üé® Cosmetics</button>
     </div>
     <div class="store-grid" id="store-container"></div>
    </div><!-- Student: Achievements -->
    <div id="achievements-section" class="content-section">
     <h2 style="font-size: 32px; font-weight: 900;">üèÖ Achievements</h2>
     <p style="color: #64748b; margin-bottom: 24px;"><span id="unlocked-count">0</span> of <span id="total-count">0</span> achievements unlocked</p>
     <div class="trophy-grid" id="trophy-container"></div>
    </div><!-- Student: Practice View -->
    <div id="practice-section" class="content-section">
     <div style="background: white; border-radius: 24px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); max-width: 800px; margin: 0 auto;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;"><button class="action-btn btn-alt" onclick="leavePractice()">‚Üê Back</button>
       <div style="display: flex; gap: 16px; flex-wrap: wrap;">
        <div style="font-weight: 700; font-size: 18px; color: #667eea;">
         ‚è±Ô∏è <span id="timer-display">0:00</span>
        </div>
        <div style="font-weight: 700; font-size: 18px; color: #48bb78;">
         ‚úì <span id="correct-count">0</span>
        </div>
        <div style="font-weight: 700; font-size: 18px; color: #f56565;">
         ‚úó <span id="wrong-count">0</span>
        </div>
       </div>
      </div>
      <div style="text-align: center; margin-bottom: 32px;">
       <div style="font-size: 64px; margin-bottom: 16px;" id="current-level-icon">
        üè∞
       </div>
       <h2 style="margin: 0; font-size: 28px; font-weight: 900;" id="current-level-name">Grade 6</h2>
       <p style="color: #64748b; margin-top: 8px;" id="current-level-desc">Pre-Algebra</p>
      </div>
      <div style="background: linear-gradient(135deg, #667eea10, #764ba210); border-radius: 16px; padding: 32px; margin-bottom: 24px; min-height: 200px; display: flex; flex-direction: column; justify-content: center;">
       <div style="font-size: 32px; font-weight: 900; color: #1a202c; margin-bottom: 24px; text-align: center; line-height: 1.4;" id="question-text">
        Loading question...
       </div>
       <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;" id="answer-options">
       </div>
      </div>
      <style>
            @media (max-width: 768px) {
              #question-text {
                font-size: 24px !important;
              }
              #answer-options {
                grid-template-columns: 1fr !important;
                gap: 12px !important;
              }
              #answer-options button {
                font-size: 18px !important;
                padding: 24px 20px !important;
                min-height: 64px !important;
              }
            }
          </style>
      <div style="text-align: center; color: #64748b; font-size: 14px; font-weight: 600;">
       Question <span id="question-num">1</span> of <span id="question-total">10</span>
      </div>
     </div>
    </div><!-- Teacher: Dashboard -->
    <div id="teacher-dashboard-section" class="content-section">
     <h2 style="font-size: 32px; font-weight: 900;">üìä Teacher Dashboard</h2>
     <p style="color: #64748b; margin-bottom: 24px;">Welcome to your teaching control center</p>
     <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 32px;">
      <div style="background: white; padding: 24px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
       <div style="font-size: 40px; margin-bottom: 12px;">
        üë•
       </div>
       <div style="font-size: 32px; font-weight: 900; color: #667eea; margin-bottom: 8px;" id="teacher-student-count">
        15
       </div>
       <div style="font-size: 14px; color: #64748b; font-weight: 600;">
        Total Students
       </div>
      </div>
      <div style="background: white; padding: 24px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
       <div style="font-size: 40px; margin-bottom: 12px;">
        üìù
       </div>
       <div style="font-size: 32px; font-weight: 900; color: #667eea; margin-bottom: 8px;" id="teacher-assignment-count">
        5
       </div>
       <div style="font-size: 14px; color: #64748b; font-weight: 600;">
        Active Assignments
       </div>
      </div>
      <div style="background: white; padding: 24px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
       <div style="font-size: 40px; margin-bottom: 12px;">
        ‚úÖ
       </div>
       <div style="font-size: 32px; font-weight: 900; color: #667eea; margin-bottom: 8px;" id="teacher-completed-count">
        42
       </div>
       <div style="font-size: 14px; color: #64748b; font-weight: 600;">
        Completed This Week
       </div>
      </div>
      <div style="background: white; padding: 24px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
       <div style="font-size: 40px; margin-bottom: 12px;">
        üìà
       </div>
       <div style="font-size: 32px; font-weight: 900; color: #667eea; margin-bottom: 8px;" id="teacher-average-score">
        87%
       </div>
       <div style="font-size: 14px; color: #64748b; font-weight: 600;">
        Class Average
       </div>
      </div>
     </div>
     <div style="background: white; border-radius: 20px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
      <h3 style="margin-top: 0; font-size: 24px; font-weight: 900;">üìÖ Recent Activity</h3>
      <div id="teacher-activity-list">
       <div style="padding: 16px; border-bottom: 1px solid #e2e8f0; display: flex; gap: 16px; align-items: center;">
        <div style="font-size: 32px;">
         ‚úÖ
        </div>
        <div style="flex: 1;">
         <div style="font-weight: 800; margin-bottom: 4px;">
          Sarah completed Level 3
         </div>
         <div style="color: #64748b; font-size: 14px;">
          Achieved 95% accuracy
         </div>
        </div>
        <div style="color: #94a3b8; font-size: 13px;">
         2h ago
        </div>
       </div>
      </div>
     </div>
    </div><!-- Teacher: Students -->
    <div id="teacher-students-section" class="content-section">
     <h2 style="font-size: 32px; font-weight: 900;">üë• My Students</h2>
     <p style="color: #64748b; margin-bottom: 24px;">Organize students into groups and track their progress</p>
     <div style="display: grid; gap: 24px;"><!-- Create Group Section -->
      <div style="background: white; border-radius: 20px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
       <h3 style="margin-top: 0; font-size: 24px; font-weight: 900;">‚ûï Create New Group</h3>
       <form onsubmit="createGroup(event)" style="display: grid; gap: 16px;">
        <div><label for="group-name" style="display: block; font-weight: 700; margin-bottom: 8px; color: #1a202c;">Group Name</label> <input type="text" id="group-name" required placeholder="e.g., Grade 7A, Advanced Math" style="width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit;">
        </div>
        <div><label for="group-description" style="display: block; font-weight: 700; margin-bottom: 8px; color: #1a202c;">Description (Optional)</label> <input type="text" id="group-description" placeholder="e.g., Monday &amp; Wednesday class" style="width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit;">
        </div><button type="submit" class="action-btn btn-main" style="width: auto; justify-self: start;">Create Group</button>
       </form>
      </div><!-- Groups List -->
      <div style="background: white; border-radius: 20px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
       <h3 style="margin-top: 0; font-size: 24px; font-weight: 900;">üìö My Groups</h3>
       <div id="groups-container"></div>
      </div><!-- Add Student Section -->
      <div style="background: white; border-radius: 20px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
       <h3 style="margin-top: 0; font-size: 24px; font-weight: 900;">üë®‚Äçüéì Add Student to Group</h3>
       <form onsubmit="addStudentToGroup(event)" style="display: grid; gap: 16px;">
        <div><label for="student-name" style="display: block; font-weight: 700; margin-bottom: 8px; color: #1a202c;">Student Name</label> <input type="text" id="student-name" required placeholder="Enter student's full name" style="width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit;">
        </div>
        <div><label for="student-email" style="display: block; font-weight: 700; margin-bottom: 8px; color: #1a202c;">Student Email</label> <input type="email" id="student-email" required placeholder="student@email.com" style="width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit;">
        </div>
        <div><label for="select-group" style="display: block; font-weight: 700; margin-bottom: 8px; color: #1a202c;">Select Group</label> <select id="select-group" required style="width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit; background: white;"> <option value="">Choose a group...</option> </select>
        </div><button type="submit" class="action-btn btn-main" style="width: auto; justify-self: start;">Add Student</button>
       </form>
      </div>
     </div>
    </div><!-- Teacher: Assignments -->
    <div id="teacher-assignments-section" class="content-section">
     <h2 style="font-size: 32px; font-weight: 900;">üìù Assignments</h2>
     <p style="color: #64748b; margin-bottom: 24px;">Create and manage class assignments</p>
     <div style="background: white; border-radius: 20px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
      <p style="color: #64748b;">Assignment features coming soon!</p>
     </div>
    </div>
   </main>
   <footer class="bottom-footer">
    <p style="font-size: 20px; font-weight: 900; margin-bottom: 16px;">üßÆ Algebra Equate</p>
    <p>Gamified Learning Platform for Algebra Excellence</p>
    <p style="margin-top: 16px;">ÔøΩÔøΩ 2025 Algebra Equate. All Rights Reserved.</p>
    <p style="margin-top: 8px;"><a href="mailto:nchanges884@gmail.com" style="color: white; text-decoration: underline; font-weight: 700;">nchanges884@gmail.com</a></p>
   </footer>
  </div>
  <script>
    let userData = {
      name: 'User',
      email: 'user@example.com',
      role: 'student',
      level: 1,
      xp: 0,
      xpToNextLevel: 100,
      coins: 100,
      streak: 0,
      inventory: [],
      progress: {},
      stats: {
        timeSpent: 0,
        totalCorrect: 0,
        totalAttempted: 0
      },
      gameStats: {
        balloonHighScore: 0,
        mazeHighScore: 0,
        speedHighScore: 0
      },
      avatarColor: '#667eea',
      challenges: {
        questions: 0,
        streak: 0,
        bestStreak: 0,
        challenge1Complete: false,
        challenge2Complete: false,
        challenge3Complete: false,
        challenge4Complete: false,
        challenge5Complete: false,
        challenge6Complete: false,
        speedAttemptStarted: false,
        speedAttemptTime: 0,
        speedAttemptCorrect: 0,
        totalTimeSpentMinutes: 0
      },
      activeBoosts: {},
      activeBadge: null,
      activeTheme: 'default',
      consumables: {}
    };

    const levelData = [
      { id: 1, name: 'Foundation Kingdom', subtitle: 'Grade 6', icon: 'üè∞', locked: false, progress: 0, requiredCorrect: 10, correctAnswers: 0 },
      { id: 2, name: 'Linear Forest', subtitle: 'Grade 7', icon: 'üå≤', locked: true, progress: 0, requiredCorrect: 10, correctAnswers: 0 },
      { id: 3, name: 'Power Plains', subtitle: 'Grade 8', icon: '‚ö°', locked: true, progress: 0, requiredCorrect: 10, correctAnswers: 0 },
      { id: 4, name: 'Polynomial Peak', subtitle: 'Grade 9', icon: '‚õ∞Ô∏è', locked: true, progress: 0, requiredCorrect: 10, correctAnswers: 0 },
      { id: 5, name: 'Quadratic Realm', subtitle: 'Grade 10', icon: 'üëë', locked: true, progress: 0, requiredCorrect: 10, correctAnswers: 0 },
      { id: 6, name: 'Trigonometry Tides', subtitle: 'Grade 11', icon: 'üåä', locked: true, progress: 0, requiredCorrect: 10, correctAnswers: 0 },
      { id: 7, name: 'Calculus Cosmos', subtitle: 'Grade 12', icon: 'üöÄ', locked: true, progress: 0, requiredCorrect: 10, correctAnswers: 0 },
      { id: 8, name: 'Infinity Dimension', subtitle: 'Advanced', icon: '‚ôæÔ∏è', locked: true, progress: 0, requiredCorrect: 10, correctAnswers: 0 }
    ];

    const storeProducts = [
      { id: 'hint', name: 'Hint Token', icon: 'üí°', price: 50, category: 'general', desc: 'Get a helpful hint on any problem', consumable: true },
      { id: 'skip', name: 'Skip Token', icon: '‚è≠Ô∏è', price: 30, category: 'general', desc: 'Skip a difficult question', consumable: true },
      { id: 'time-freeze', name: 'Time Freeze', icon: '‚è∏Ô∏è', price: 75, category: 'general', desc: 'Pause the timer for 30 seconds', consumable: true },
      { id: 'auto-solve', name: 'Auto Solve', icon: 'ü§ñ', price: 100, category: 'general', desc: 'Automatically solve one question', consumable: true },
      { id: 'extra-life', name: 'Extra Life', icon: '‚ù§Ô∏è', price: 60, category: 'general', desc: 'Get one wrong answer forgiven', consumable: true },
      { id: 'double-xp', name: '2x XP Boost', icon: '‚ö°', price: 100, category: 'upgrades', desc: 'Double XP for 1 hour', duration: 3600, consumable: false },
      { id: 'triple-xp', name: '3x XP Boost', icon: '‚ö°‚ö°', price: 250, category: 'upgrades', desc: 'Triple XP for 30 minutes', duration: 1800, consumable: false },
      { id: 'coin-multiplier', name: '1.5x Coin Boost', icon: 'üí∞', price: 150, category: 'upgrades', desc: '1.5x coins for 1 hour', duration: 3600, consumable: false },
      { id: 'mega-coins', name: '2x Coin Boost', icon: 'üí∞üí∞', price: 300, category: 'upgrades', desc: 'Double coins for 30 minutes', duration: 1800, consumable: false },
      { id: 'streak-protector', name: 'Streak Shield', icon: 'üõ°Ô∏è', price: 200, category: 'upgrades', desc: 'Protect your streak for 1 day', duration: 86400, consumable: false },
      { id: 'unlock-level', name: 'Level Unlock Key', icon: 'üîì', price: 300, category: 'general', desc: 'Instantly unlock next level', consumable: true },
      { id: 'rainbow-theme', name: 'Rainbow Theme', icon: 'üåà', price: 500, category: 'cosmetics', desc: 'Beautiful rainbow color theme', permanent: true },
      { id: 'gold-theme', name: 'Gold Theme', icon: '‚ú®', price: 600, category: 'cosmetics', desc: 'Luxurious gold color theme', permanent: true },
      { id: 'neon-theme', name: 'Neon Theme', icon: 'üîÆ', price: 550, category: 'cosmetics', desc: 'Glowing neon color theme', permanent: true },
      { id: 'crown-badge', name: 'Crown Badge', icon: 'üëë', price: 400, category: 'cosmetics', desc: 'Display a crown on your profile', permanent: true },
      { id: 'star-badge', name: 'Star Badge', icon: '‚≠ê', price: 350, category: 'cosmetics', desc: 'Display a star on your profile', permanent: true },
      { id: 'fire-badge', name: 'Fire Badge', icon: 'üî•', price: 380, category: 'cosmetics', desc: 'Display a fire icon on your profile', permanent: true }
    ];

    const trophyData = [
      { id: 'first-steps', name: 'First Steps', icon: 'STEP', desc: 'Complete your first question', unlocked: false },
      { id: 'quick-learner', name: 'Quick Learner', icon: 'FAST', desc: 'Answer 10 questions correctly', unlocked: false },
      { id: 'perfectionist', name: 'Perfectionist', icon: '100%', desc: 'Get 100% on a practice session', unlocked: false },
      { id: 'streak-starter', name: 'Streak Starter', icon: 'FIRE', desc: 'Maintain a 3-day streak', unlocked: false },
      { id: 'coin-collector', name: 'Coin Collector', icon: 'COIN', desc: 'Earn 1000 coins total', unlocked: false },
      { id: 'level-master', name: 'Level Master', icon: 'GRAD', desc: 'Unlock a new level', unlocked: false }
    ];

    let activeLevelData = null;
    let sessionTimer = null;
    let sessionStartTime = 0;
    let sessionQuestions = [];
    let currentQuestionIdx = 0;
    let sessionResults = { correct: 0, wrong: 0 };
    let answerStreak = 0;
    let gameTimer = null;
    let gameState = {};
    let activeStoreFilter = 'all';
    let teacherGroups = [];
    let groupIdCounter = 1;

    document.querySelectorAll('.role-option').forEach(option => {
      option.addEventListener('click', function() {
        document.querySelectorAll('.role-option').forEach(opt => opt.classList.remove('active'));
        this.classList.add('active');
      });
    });

    function performLogin(method) {
      const selectedRole = document.querySelector('.role-option.active')?.dataset?.role || 'student';
      
      userData.role = selectedRole;
      userData.name = 'User';
      
      document.getElementById('auth-screen').classList.add('hide-element');
      document.getElementById('dashboard-app').classList.remove('hide-element');
      
      initializeRoleNavigation(selectedRole);
      initializeApplication();
      
      displayMessage(`‚ú® Welcome, ${userData.name}!`, 'success');
    }

    function initializeRoleNavigation(role) {
      document.getElementById('student-navigation').classList.add('hide-element');
      document.getElementById('teacher-navigation').classList.add('hide-element');
      
      if (role === 'student') {
        document.getElementById('student-navigation').classList.remove('hide-element');
        navigateTo('levels');
      } else if (role === 'teacher') {
        document.getElementById('teacher-navigation').classList.remove('hide-element');
        navigateTo('teacher-dashboard');
      }
      refreshHeaderDisplay();
      refreshAccountSettings();
    }

    function initializeApplication() {
      populateLevels();
      populateGames();
      populateStore();
      populateTrophies();
      refreshGameScores();
      
      if (userData.role === 'teacher') {
        refreshGroupsList();
        updateGroupDropdown();
      }
      
      refreshHeaderDisplay();
      refreshAccountSettings();
    }

    function refreshAccountSettings() {
      document.getElementById('settings-name').value = userData.name;
      document.getElementById('settings-email').value = userData.email;
      document.getElementById('settings-role').value = userData.role.charAt(0).toUpperCase() + userData.role.slice(1);
    }

    function saveProfileSettings() {
      const name = document.getElementById('settings-name').value;
      const email = document.getElementById('settings-email').value;
      
      if (name) userData.name = name;
      if (email) userData.email = email;
      
      refreshHeaderDisplay();
      displayMessage('‚úÖ Account information saved!', 'success');
    }

    function updateAvatarColor(color) {
      userData.avatarColor = color;
      document.getElementById('profile-avatar').style.background = color;
      displayMessage('üé® Avatar color updated!', 'success');
    }

    function refreshHeaderDisplay() {
      document.getElementById('profile-name').textContent = userData.name;
      document.getElementById('profile-role-level').textContent = `${userData.role.charAt(0).toUpperCase() + userData.role.slice(1)} ‚Ä¢ Level ${userData.level}`;
      document.getElementById('profile-avatar').textContent = userData.name[0].toUpperCase();
      document.getElementById('profile-avatar').style.background = userData.avatarColor;
      document.getElementById('coins-display').textContent = userData.coins;
      document.getElementById('xp-display').textContent = `${userData.xp} XP`;
      document.getElementById('streak-display').textContent = userData.streak;
      
      const xpPercentage = (userData.xp / userData.xpToNextLevel) * 100;
      document.getElementById('xp-progress').style.width = `${xpPercentage}%`;
    }

    function populateLevels() {
      const container = document.getElementById('level-container');
      container.innerHTML = levelData.map(level => `
        <div class="level-item ${level.locked ? 'disabled' : ''}" onclick="${level.locked ? '' : `chooseLevel(${level.id})`}">
          <div style="font-size: 48px; font-weight: 900; color: #667eea; background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 16px; margin-bottom: 16px; display: inline-block;">${level.icon}</div>
          <div class="level-title">${level.name}</div>
          <div class="level-desc">${level.subtitle}</div>
          ${level.locked ? '<div style="position: absolute; top: 16px; right: 16px; font-size: 20px; font-weight: 900; color: #94a3b8;">LOCKED</div>' : ''}
          <div class="progress-track">
            <div class="progress-fill" style="width: ${level.progress}%"></div>
          </div>
          <div style="margin-top: 8px; font-size: 13px; color: #667eea; font-weight: 700;">${level.correctAnswers}/${level.requiredCorrect} correct to unlock next</div>
        </div>
      `).join('');
    }

    function chooseLevel(levelId) {
      activeLevelData = levelData.find(l => l.id === levelId);
      if (activeLevelData && !activeLevelData.locked) {
        displayMessage(`üéØ Starting ${activeLevelData.name}!`, 'success');
        beginPractice(activeLevelData.id);
      }
    }

    function beginPractice(levelId) {
      activeLevelData = levelData.find(l => l.id === levelId);
      sessionQuestions = buildQuestions(levelId, 10);
      currentQuestionIdx = 0;
      sessionResults = { correct: 0, wrong: 0 };
      answerStreak = 0;
      sessionStartTime = Date.now();
      
      document.querySelectorAll('.content-section').forEach(section => section.classList.remove('showing'));
      document.getElementById('practice-section').classList.add('showing');
      
      document.getElementById('current-level-icon').textContent = activeLevelData.icon;
      document.getElementById('current-level-name').textContent = activeLevelData.name;
      document.getElementById('current-level-desc').textContent = activeLevelData.subtitle;
      document.getElementById('question-total').textContent = sessionQuestions.length;
      
      startTimer();
      displayCurrentQuestion();
    }

    function buildQuestions(levelId, count) {
      const questions = [];
      for (let i = 0; i < count; i++) {
        const { question, answer } = createQuestion(levelId);
        const wrongAnswers = [
          answer + Math.floor(Math.random() * 5) + 1,
          answer - Math.floor(Math.random() * 5) - 1,
          answer + Math.floor(Math.random() * 10) + 5
        ].filter(w => w !== answer);
        const options = [answer, ...wrongAnswers.slice(0, 3)].sort(() => Math.random() - 0.5).slice(0, 4);
        questions.push({ question, answer, options });
      }
      return questions;
    }

    function createQuestion(levelId) {
      const a = Math.floor(Math.random() * 20) - 10;
      const b = Math.floor(Math.random() * 20) - 10;
      const operations = ['+', '-', '√ó'];
      const op = operations[Math.floor(Math.random() * operations.length)];
      let answer;
      if (op === '+') answer = a + b;
      else if (op === '-') answer = a - b;
      else answer = a * b;
      return { question: `${a} ${op} ${b} = ?`, answer };
    }

    function startTimer() {
      if (sessionTimer) clearInterval(sessionTimer);
      sessionTimer = setInterval(() => {
        const elapsed = Math.floor((Date.now() - sessionStartTime) / 1000);
        const minutes = Math.floor(elapsed / 60);
        const seconds = elapsed % 60;
        document.getElementById('timer-display').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
      }, 1000);
    }

    function displayCurrentQuestion() {
      if (currentQuestionIdx >= sessionQuestions.length) {
        finishPracticeSession();
        return;
      }

      const question = sessionQuestions[currentQuestionIdx];
      document.getElementById('question-num').textContent = currentQuestionIdx + 1;
      document.getElementById('question-text').textContent = question.question;
      document.getElementById('correct-count').textContent = sessionResults.correct;
      document.getElementById('wrong-count').textContent = sessionResults.wrong;

      const optionsContainer = document.getElementById('answer-options');
      optionsContainer.innerHTML = question.options.map(option => `
        <button class="action-btn btn-alt" onclick="checkAnswer(${option}, ${question.answer})" style="padding: 20px; font-size: 20px; font-weight: 800;">
          ${option}
        </button>
      `).join('');
    }

    function checkAnswer(selected, correct) {
      const isCorrect = Math.abs(selected - correct) < 0.01;

      if (isCorrect) {
        sessionResults.correct++;
        answerStreak++;
        userData.stats.totalCorrect++;
        
        const coinMultiplier = getActiveCoinMultiplier();
        const xpMultiplier = getActiveXPMultiplier();
        
        const coinsEarned = Math.floor(5 * coinMultiplier);
        const xpEarned = Math.floor(10 * xpMultiplier);
        
        userData.coins += coinsEarned;
        userData.xp += xpEarned;
        
        userData.challenges.questions++;
        if (answerStreak > userData.challenges.bestStreak) {
          userData.challenges.bestStreak = answerStreak;
        }
        
        refreshChallengeProgress();
        
        let message = `‚úÖ Correct! +${coinsEarned} coins +${xpEarned} XP`;
        if (coinMultiplier > 1 || xpMultiplier > 1) {
          message += ` üî•`;
        }
        displayMessage(message, 'success');
        
        if (sessionResults.correct === 1) {
          awardTrophy('first-steps');
        }
        if (sessionResults.correct === 10) {
          awardTrophy('quick-learner');
        }
        
        activeLevelData.correctAnswers++;
        activeLevelData.progress = Math.min(100, (activeLevelData.correctAnswers / activeLevelData.requiredCorrect) * 100);
        
        if (activeLevelData.correctAnswers >= activeLevelData.requiredCorrect) {
          const nextLevel = levelData.find(l => l.id === activeLevelData.id + 1);
          if (nextLevel && nextLevel.locked) {
            nextLevel.locked = false;
            awardTrophy('level-master');
            displayMessage(`üîì Level Unlocked: ${nextLevel.name}!`, 'success');
          }
        }
      } else {
        sessionResults.wrong++;
        answerStreak = 0;
        displayMessage(`‚ùå Wrong! Correct answer: ${correct}`, 'warning');
      }

      userData.stats.totalAttempted++;
      
      if (userData.xp >= userData.xpToNextLevel) {
        userData.level++;
        userData.xp = 0;
        userData.xpToNextLevel = Math.floor(userData.xpToNextLevel * 1.5);
        displayMessage(`üéâ Level Up! Now Level ${userData.level}!`, 'success');
      }
      
      refreshHeaderDisplay();
      populateLevels();
      
      setTimeout(() => {
        currentQuestionIdx++;
        displayCurrentQuestion();
      }, 1500);
    }

    function refreshChallengeProgress() {
      const bar1 = document.getElementById('challenge1-bar');
      const text1 = document.getElementById('challenge1-text');
      const bar2 = document.getElementById('challenge2-bar');
      const text2 = document.getElementById('challenge2-text');
      const bar6 = document.getElementById('challenge6-bar');
      const text6 = document.getElementById('challenge6-text');
      
      if (bar1) {
        const progress1 = Math.min(100, (userData.challenges.questions / 20) * 100);
        bar1.style.width = progress1 + '%';
        text1.textContent = `${userData.challenges.questions}/20 completed`;
        
        if (userData.challenges.questions >= 20 && !userData.challenges.challenge1Complete) {
          userData.challenges.challenge1Complete = true;
          userData.coins += 100;
          userData.xp += 50;
          refreshHeaderDisplay();
          displayMessage('üéâ Challenge Complete! +100 Coins +50 XP', 'success');
        }
      }
      
      if (bar2) {
        const progress2 = Math.min(100, (userData.challenges.bestStreak / 5) * 100);
        bar2.style.width = progress2 + '%';
        text2.textContent = `${userData.challenges.bestStreak}/5 completed`;
        
        if (userData.challenges.bestStreak >= 5 && !userData.challenges.challenge2Complete) {
          userData.challenges.challenge2Complete = true;
          userData.coins += 150;
          userData.xp += 75;
          refreshHeaderDisplay();
          displayMessage('üéâ Challenge Complete! +150 Coins +75 XP', 'success');
        }
      }
      
      if (bar6) {
        const progress6 = Math.min(100, (userData.challenges.totalTimeSpentMinutes / 30) * 100);
        bar6.style.width = progress6 + '%';
        text6.textContent = `${userData.challenges.totalTimeSpentMinutes}/30 minutes`;
        
        if (userData.challenges.totalTimeSpentMinutes >= 30 && !userData.challenges.challenge6Complete) {
          userData.challenges.challenge6Complete = true;
          userData.coins += 120;
          userData.xp += 60;
          refreshHeaderDisplay();
          displayMessage('üéâ Study Session Complete! +120 Coins +60 XP', 'success');
        }
      }
    }

    function awardTrophy(trophyId) {
      const trophy = trophyData.find(t => t.id === trophyId);
      if (trophy && !trophy.unlocked) {
        trophy.unlocked = true;
        displayMessage(`üèÖ Achievement Unlocked: ${trophy.name}!`, 'success');
        userData.coins += 50;
        refreshHeaderDisplay();
        populateTrophies();
      }
    }

    function finishPracticeSession() {
      if (sessionTimer) {
        clearInterval(sessionTimer);
        sessionTimer = null;
      }
      
      const totalQuestions = sessionQuestions.length;
      const accuracy = Math.round((sessionResults.correct / totalQuestions) * 100);
      
      if (accuracy === 100) {
        awardTrophy('perfectionist');
        
        if (!userData.challenges.challenge4Complete) {
          userData.challenges.challenge4Complete = true;
          userData.coins += 250;
          userData.xp += 125;
          const bar4 = document.getElementById('challenge4-bar');
          const text4 = document.getElementById('challenge4-text');
          if (bar4) bar4.style.width = '100%';
          if (text4) text4.textContent = 'Completed!';
          refreshHeaderDisplay();
          displayMessage('üéâ Perfect Score Challenge Complete! +250 Coins +125 XP', 'success');
        }
      }
      
      const elapsed = Math.floor((Date.now() - sessionStartTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;
      
      const minutesSpent = Math.floor(elapsed / 60);
      if (minutesSpent > 0) {
        userData.challenges.totalTimeSpentMinutes += minutesSpent;
        refreshChallengeProgress();
      }
      
      if (totalQuestions === 10 && elapsed <= 120 && sessionResults.correct === 10) {
        if (!userData.challenges.challenge3Complete) {
          userData.challenges.challenge3Complete = true;
          userData.coins += 200;
          userData.xp += 100;
          const bar3 = document.getElementById('challenge3-bar');
          const text3 = document.getElementById('challenge3-text');
          if (bar3) bar3.style.width = '100%';
          if (text3) text3.textContent = 'Completed!';
          refreshHeaderDisplay();
          displayMessage('üéâ Speed Demon Challenge Complete! +200 Coins +100 XP', 'success');
        }
      }
      
      const resultHTML = `
        <div style="text-align: center; padding: 40px;">
          <div style="font-size: 80px; margin-bottom: 24px;">
            ${accuracy >= 90 ? 'üéâ' : accuracy >= 70 ? 'üëè' : 'üí™'}
          </div>
          <h2 style="font-size: 36px; font-weight: 900; margin-bottom: 16px;">
            ${accuracy >= 90 ? 'Excellent!' : accuracy >= 70 ? 'Good Job!' : 'Keep Practicing!'}
          </h2>
          <p style="font-size: 20px; color: #64748b; margin-bottom: 32px;">
            You scored ${accuracy}% accuracy
          </p>
          
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 32px;">
            <div style="padding: 20px; background: rgba(72, 187, 120, 0.1); border-radius: 16px;">
              <div style="font-size: 32px; font-weight: 900; color: #48bb78; margin-bottom: 8px;">
                ${sessionResults.correct}
              </div>
              <div style="color: #64748b; font-weight: 700;">Correct</div>
            </div>
            <div style="padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: 16px;">
              <div style="font-size: 32px; font-weight: 900; color: #ef4444; margin-bottom: 8px;">
                ${sessionResults.wrong}
              </div>
              <div style="color: #64748b; font-weight: 700;">Wrong</div>
            </div>
            <div style="padding: 20px; background: rgba(102, 126, 234, 0.1); border-radius: 16px;">
              <div style="font-size: 32px; font-weight: 900; color: #667eea; margin-bottom: 8px;">
                ${minutes}:${seconds.toString().padStart(2, '0')}
              </div>
              <div style="color: #64748b; font-weight: 700;">Time</div>
            </div>
          </div>
          
          <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
            <button class="action-btn btn-alt" onclick="leavePractice()">Back to Levels</button>
            <button class="action-btn btn-main" onclick="beginPractice(${activeLevelData.id})">Try Again</button>
          </div>
        </div>
      `;
      
      const practiceSection = document.getElementById('practice-section');
      practiceSection.innerHTML = `
        <div style="background: white; border-radius: 24px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); max-width: 800px; margin: 0 auto;">
          ${resultHTML}
        </div>
      `;
    }

    function leavePractice() {
      if (sessionTimer) {
        clearInterval(sessionTimer);
        sessionTimer = null;
      }
      navigateTo('levels');
    }

    function populateGames() {
      const games = [
        { id: 'balloon-pop', name: 'Balloon Pop', icon: 'üéà', desc: 'Pop balloons with correct answers! Race against time.', difficulty: 'Easy' },
        { id: 'math-maze', name: 'Math Maze', icon: 'üåÄ', desc: 'Navigate through a maze by solving equations', difficulty: 'Medium' },
        { id: 'speed-solve', name: 'Speed Solve', icon: '‚ö°', desc: 'Solve as many problems as you can in 60 seconds!', difficulty: 'Hard' }
      ];
      
      const container = document.getElementById('game-container');
      container.innerHTML = games.map(game => `
        <div class="game-item" onclick="startGame('${game.id}')">
          <div class="game-emoji">${game.icon}</div>
          <div class="game-title">${game.name}</div>
          <div class="game-description">${game.desc}</div>
          <div style="display: inline-block; padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 700; background: ${game.difficulty === 'Easy' ? 'rgba(72, 187, 120, 0.15)' : game.difficulty === 'Medium' ? 'rgba(251, 191, 36, 0.15)' : 'rgba(239, 68, 68, 0.15)'}; color: ${game.difficulty === 'Easy' ? '#38a169' : game.difficulty === 'Medium' ? '#f59e0b' : '#dc2626'};">
            ${game.difficulty}
          </div>
          <button class="action-btn btn-main" onclick="event.stopPropagation(); startGame('${game.id}')" style="margin-top: 16px; width: 100%;">
            üéÆ Play Now
          </button>
        </div>
      `).join('');
    }

    function refreshGameScores() {
      const balloonElement = document.getElementById('balloon-record');
      const mazeElement = document.getElementById('maze-record');
      const speedElement = document.getElementById('speed-record');
      
      if (balloonElement) balloonElement.textContent = userData.gameStats.balloonHighScore;
      if (mazeElement) mazeElement.textContent = userData.gameStats.mazeHighScore;
      if (speedElement) speedElement.textContent = userData.gameStats.speedHighScore;
    }

    function startGame(gameId) {
      if (gameId === 'balloon-pop') startBalloonPop();
      else if (gameId === 'math-maze') startMathMaze();
      else if (gameId === 'speed-solve') startSpeedSolve();
    }

    function startBalloonPop() {
      gameState = { score: 0, timeLeft: 60 };
      const modal = document.createElement('div');
      modal.id = 'game-modal';
      modal.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #667eea, #764ba2); z-index: 3000; padding: 20px; overflow-y: auto;">
          <div style="color: white;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 12px;">
              <button class="action-btn btn-alt" onclick="endGame()">Exit</button>
              <div style="font-size: 20px; font-weight: 800;">
                ‚è±Ô∏è <span id="game-time">60</span>s | üéØ <span id="game-score">0</span>
              </div>
            </div>
            <div style="background: rgba(255,255,255,0.2); padding: 30px; border-radius: 20px; text-align: center;">
              <div style="font-size: 32px; font-weight: 900; margin-bottom: 20px;" id="game-question">Loading...</div>
              <div id="game-balloons" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;"></div>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      
      gameTimer = setInterval(() => {
        gameState.timeLeft--;
        document.getElementById('game-time').textContent = gameState.timeLeft;
        if (gameState.timeLeft <= 0) endGame();
      }, 1000);
      
      nextBalloonQuestion();
    }

    function nextBalloonQuestion() {
      const q = createQuestion(1);
      gameState.currentQuestion = q;
      
      const wrongAnswers = [
        q.answer + Math.floor(Math.random() * 5) + 1,
        q.answer - Math.floor(Math.random() * 5) - 1,
        q.answer + Math.floor(Math.random() * 10) + 5
      ];
      const options = [q.answer, ...wrongAnswers].sort(() => Math.random() - 0.5).slice(0, 4);
      
      document.getElementById('game-question').textContent = q.question;
      document.getElementById('game-balloons').innerHTML = options.map(opt => `
        <button class="action-btn btn-main" onclick="checkBalloon(${opt})" style="font-size: 24px; padding: 30px;">
          üéà<br>${opt}
        </button>
      `).join('');
    }

    function checkBalloon(selected) {
      if (selected === gameState.currentQuestion.answer) {
        gameState.score += 10;
        document.getElementById('game-score').textContent = gameState.score;
        displayMessage('üéà Correct!', 'success');
        nextBalloonQuestion();
      } else {
        displayMessage('‚ùå Wrong!', 'warning');
      }
    }

    function startMathMaze() {
      gameState = { score: 0, position: 0, questions: [], currentQ: 0, pathLength: 10 };
      
      for (let i = 0; i < gameState.pathLength; i++) {
        gameState.questions.push(createQuestion(1));
      }
      
      const modal = document.createElement('div');
      modal.id = 'game-modal';
      modal.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #14b8a6, #0d9488); z-index: 3000; padding: 20px; overflow-y: auto;">
          <div style="color: white;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 12px;">
              <button class="action-btn btn-alt" onclick="endGame()">Exit</button>
              <div style="font-size: 20px; font-weight: 800;">
                üåÄ Progress: <span id="maze-progress">0</span>/${gameState.pathLength} | üéØ <span id="game-score">0</span>
              </div>
            </div>
            
            <div style="background: rgba(255,255,255,0.2); padding: 30px; border-radius: 20px; margin-bottom: 20px;">
              <div style="display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center;" id="maze-path">
              </div>
            </div>
            
            <div style="background: rgba(255,255,255,0.2); padding: 30px; border-radius: 20px; text-align: center;">
              <div style="font-size: 32px; font-weight: 900; margin-bottom: 20px;" id="game-question">Loading...</div>
              <div id="game-options" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;"></div>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      
      updateMazePath();
      nextMazeQuestion();
    }
    
    function updateMazePath() {
      const pathContainer = document.getElementById('maze-path');
      pathContainer.innerHTML = '';
      
      for (let i = 0; i < gameState.pathLength; i++) {
        const node = document.createElement('div');
        node.style.cssText = `
          width: 50px;
          height: 50px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
          font-weight: 900;
          transition: all 0.3s;
        `;
        
        if (i < gameState.position) {
          node.style.background = 'rgba(72, 187, 120, 0.9)';
          node.textContent = '‚úì';
        } else if (i === gameState.position) {
          node.style.background = 'rgba(251, 191, 36, 0.9)';
          node.style.transform = 'scale(1.2)';
          node.textContent = 'üë§';
        } else {
          node.style.background = 'rgba(255, 255, 255, 0.3)';
          node.textContent = i + 1;
        }
        
        pathContainer.appendChild(node);
      }
    }
    
    function nextMazeQuestion() {
      if (gameState.position >= gameState.pathLength) {
        endGame();
        return;
      }
      
      const q = gameState.questions[gameState.position];
      
      const wrongAnswers = [
        q.answer + Math.floor(Math.random() * 5) + 1,
        q.answer - Math.floor(Math.random() * 5) - 1,
        q.answer + Math.floor(Math.random() * 10) + 5
      ];
      const options = [q.answer, ...wrongAnswers].sort(() => Math.random() - 0.5).slice(0, 4);
      
      document.getElementById('game-question').textContent = q.question;
      document.getElementById('game-options').innerHTML = options.map(opt => `
        <button class="action-btn btn-main" onclick="checkMazeAnswer(${opt}, ${q.answer})" style="font-size: 22px; padding: 20px;">
          ${opt}
        </button>
      `).join('');
    }
    
    function checkMazeAnswer(selected, correct) {
      if (selected === correct) {
        gameState.position++;
        gameState.score += 10;
        document.getElementById('game-score').textContent = gameState.score;
        document.getElementById('maze-progress').textContent = gameState.position;
        displayMessage('‚úì Correct! Moving forward...', 'success');
        updateMazePath();
        
        if (gameState.position >= gameState.pathLength) {
          setTimeout(() => endGame(), 1000);
        } else {
          setTimeout(() => nextMazeQuestion(), 800);
        }
      } else {
        displayMessage('‚ùå Wrong! Try again.', 'warning');
      }
    }

    function startSpeedSolve() {
      gameState = { score: 0, timeLeft: 60, questionsAnswered: 0 };
      
      const modal = document.createElement('div');
      modal.id = 'game-modal';
      modal.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #f59e0b, #d97706); z-index: 3000; padding: 20px; overflow-y: auto;">
          <div style="color: white;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 12px;">
              <button class="action-btn btn-alt" onclick="endGame()">Exit</button>
              <div style="font-size: 20px; font-weight: 800;">
                ‚è±Ô∏è <span id="game-time">60</span>s | ‚ö° <span id="questions-answered">0</span> solved | üéØ <span id="game-score">0</span>
              </div>
            </div>
            
            <div style="background: rgba(255,255,255,0.2); padding: 40px; border-radius: 20px; text-align: center;">
              <div style="font-size: 48px; font-weight: 900; margin-bottom: 30px; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);" id="game-question">Loading...</div>
              <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; align-items: center;">
                <input type="number" id="speed-answer" placeholder="Answer" style="padding: 20px; font-size: 28px; font-weight: 900; border: none; border-radius: 16px; width: 200px; text-align: center; font-family: inherit;" autofocus>
                <button class="action-btn btn-main" onclick="checkSpeedAnswer()" style="font-size: 24px; padding: 20px 40px;">
                  Submit ‚Üí
                </button>
              </div>
              <div style="margin-top: 20px; font-size: 18px; opacity: 0.9;">
                Press Enter to submit quickly!
              </div>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      
      gameTimer = setInterval(() => {
        gameState.timeLeft--;
        document.getElementById('game-time').textContent = gameState.timeLeft;
        if (gameState.timeLeft <= 0) endGame();
      }, 1000);
      
      document.getElementById('speed-answer').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          checkSpeedAnswer();
        }
      });
      
      nextSpeedQuestion();
    }
    
    function nextSpeedQuestion() {
      const q = createQuestion(1);
      gameState.currentQuestion = q;
      
      document.getElementById('game-question').textContent = q.question;
      document.getElementById('speed-answer').value = '';
      document.getElementById('speed-answer').focus();
    }
    
    function checkSpeedAnswer() {
      const input = document.getElementById('speed-answer');
      const answer = parseInt(input.value);
      
      if (isNaN(answer)) {
        displayMessage('‚ö†Ô∏è Please enter a number!', 'warning');
        return;
      }
      
      if (answer === gameState.currentQuestion.answer) {
        gameState.score += 10;
        gameState.questionsAnswered++;
        document.getElementById('game-score').textContent = gameState.score;
        document.getElementById('questions-answered').textContent = gameState.questionsAnswered;
        displayMessage('‚ö° Correct!', 'success');
        nextSpeedQuestion();
      } else {
        displayMessage(`‚ùå Wrong! Answer: ${gameState.currentQuestion.answer}`, 'warning');
        nextSpeedQuestion();
      }
    }

    function endGame() {
      if (gameTimer) clearInterval(gameTimer);
      const modal = document.getElementById('game-modal');
      if (modal) {
        userData.coins += gameState.score;
        
        let gameType = 'balloon';
        let highScoreUpdated = false;
        
        if (modal.innerHTML.includes('#14b8a6')) {
          gameType = 'maze';
          if (gameState.score > userData.gameStats.mazeHighScore) {
            userData.gameStats.mazeHighScore = gameState.score;
            highScoreUpdated = true;
          }
        } else if (modal.innerHTML.includes('#f59e0b')) {
          gameType = 'speed';
          if (gameState.score > userData.gameStats.speedHighScore) {
            userData.gameStats.speedHighScore = gameState.score;
            highScoreUpdated = true;
          }
        } else {
          if (gameState.score > userData.gameStats.balloonHighScore) {
            userData.gameStats.balloonHighScore = gameState.score;
            highScoreUpdated = true;
          }
        }
        
        refreshGameScores();
        
        if (gameState.score >= 100 && !userData.challenges.challenge5Complete) {
          userData.challenges.challenge5Complete = true;
          userData.coins += 175;
          userData.xp += 85;
          const bar5 = document.getElementById('challenge5-bar');
          const text5 = document.getElementById('challenge5-text');
          if (bar5) bar5.style.width = '100%';
          if (text5) text5.textContent = 'Completed!';
          displayMessage('üéâ Game Master Challenge Complete! +175 Coins +85 XP', 'success');
        }
        
        refreshHeaderDisplay();
        
        const emoji = gameType === 'maze' ? 'üåÄ' : gameType === 'speed' ? '‚ö°' : 'üéà';
        const gameName = gameType === 'maze' ? 'Math Maze' : gameType === 'speed' ? 'Speed Solve' : 'Balloon Pop';
        
        modal.innerHTML = `
          <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); z-index: 3000; display: flex; align-items: center; justify-content: center; padding: 20px;">
            <div style="background: white; padding: 50px; border-radius: 30px; text-align: center; max-width: 400px; width: 100%;">
              <div style="font-size: 64px; margin-bottom: 20px;">${emoji}</div>
              <h2 style="font-size: 32px; margin-bottom: 8px; font-weight: 900;">${gameName}</h2>
              <p style="font-size: 18px; color: #64748b; margin-bottom: 24px;">Game Complete!</p>
              <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(240, 147, 251, 0.1)); padding: 24px; border-radius: 20px; margin-bottom: 24px;">
                <div style="font-size: 48px; color: #667eea; font-weight: 900; margin-bottom: 8px;">${gameState.score}</div>
                <div style="font-size: 14px; color: #64748b; font-weight: 700;">FINAL SCORE</div>
                ${highScoreUpdated ? '<div style="margin-top: 12px; color: #48bb78; font-weight: 800; font-size: 15px;">üéâ NEW HIGH SCORE!</div>' : ''}
              </div>
              <div style="margin-bottom: 24px; padding: 16px; background: rgba(251, 191, 36, 0.1); border-radius: 12px;">
                <div style="font-size: 14px; color: #64748b; margin-bottom: 4px;">Coins Earned</div>
                <div style="font-size: 24px; color: #f59e0b; font-weight: 900;">+${gameState.score} ü™ô</div>
              </div>
              <button class="action-btn btn-main" onclick="closeGame()" style="width: 100%;">Back to Games</button>
            </div>
          </div>
        `;
      }
    }

    function closeGame() {
      const modal = document.getElementById('game-modal');
      if (modal) modal.remove();
    }

    function filterStore(category) {
      activeStoreFilter = category;
      document.querySelectorAll('.category-tab').forEach(btn => btn.classList.remove('selected'));
      event.target.classList.add('selected');
      populateStore();
    }

    function populateStore() {
      const filteredItems = activeStoreFilter === 'all' 
        ? storeProducts 
        : storeProducts.filter(item => item.category === activeStoreFilter);
      
      const container = document.getElementById('store-container');
      container.innerHTML = filteredItems.map(item => {
        const owned = userData.inventory.includes(item.id);
        const consumableCount = userData.consumables[item.id] || 0;
        const isActive = userData.activeBoosts[item.id] && userData.activeBoosts[item.id] > Date.now();
        
        let buttonText = 'Buy';
        let buttonDisabled = false;
        
        if (item.consumable) {
          if (consumableCount > 0) {
            buttonText = `Buy (${consumableCount} owned)`;
          }
        } else if (item.permanent) {
          if (owned) {
            buttonText = '‚úì Owned';
            buttonDisabled = true;
          }
        } else if (item.duration) {
          if (isActive) {
            const timeLeft = Math.ceil((userData.activeBoosts[item.id] - Date.now()) / 60000);
            buttonText = `Active (${timeLeft}m)`;
          } else {
            buttonText = 'Activate';
          }
        }
        
        return `
          <div class="store-product">
            <div class="product-emoji">${item.icon}</div>
            <div class="product-name">${item.name}</div>
            <div class="product-info">${item.desc}</div>
            ${consumableCount > 0 ? `<div style="text-align: center; font-weight: 700; color: #48bb78; font-size: 13px; margin-bottom: 8px;">Owned: ${consumableCount}</div>` : ''}
            ${isActive ? `<div style="text-align: center; font-weight: 700; color: #667eea; font-size: 13px; margin-bottom: 8px;">‚ö° ACTIVE</div>` : ''}
            <div class="product-purchase">
              <div class="product-cost">ü™ô ${item.price}</div>
              <button class="purchase-btn" onclick="purchaseStoreItem('${item.id}', ${item.price})" ${buttonDisabled ? 'disabled' : ''}>
                ${buttonText}
              </button>
            </div>
          </div>
        `;
      }).join('');
    }

    function purchaseStoreItem(itemId, price) {
      const item = storeProducts.find(p => p.id === itemId);
      
      if (item.consumable) {
        if (userData.coins >= price) {
          userData.coins -= price;
          userData.consumables[itemId] = (userData.consumables[itemId] || 0) + 1;
          
          if (!userData.inventory.includes(itemId)) {
            userData.inventory.push(itemId);
          }
          
          refreshHeaderDisplay();
          populateStore();
          displayMessage(`‚úÖ ${item.name} purchased! You have ${userData.consumables[itemId]}`, 'success');
          
          if (itemId === 'unlock-level') {
            useUnlockLevel();
          }
        } else {
          displayMessage(`‚ö†Ô∏è Not enough coins! You need ${price - userData.coins} more.`, 'warning');
        }
      }
      else if (item.permanent) {
        if (userData.coins >= price && !userData.inventory.includes(itemId)) {
          userData.coins -= price;
          userData.inventory.push(itemId);
          
          if (item.category === 'cosmetics') {
            if (itemId.includes('theme')) {
              applyTheme(itemId);
            } else if (itemId.includes('badge')) {
              applyBadge(itemId);
            }
          }
          
          refreshHeaderDisplay();
          populateStore();
          displayMessage(`‚úÖ ${item.name} purchased and equipped!`, 'success');
        } else if (userData.inventory.includes(itemId)) {
          displayMessage(`‚ÑπÔ∏è You already own this item!`, 'info');
        } else {
          displayMessage(`‚ö†Ô∏è Not enough coins! You need ${price - userData.coins} more.`, 'warning');
        }
      }
      else if (item.duration) {
        if (userData.coins >= price) {
          userData.coins -= price;
          
          if (!userData.inventory.includes(itemId)) {
            userData.inventory.push(itemId);
          }
          
          activateBoost(itemId, item.duration);
          refreshHeaderDisplay();
          populateStore();
          displayMessage(`‚úÖ ${item.name} activated!`, 'success');
        } else {
          displayMessage(`‚ö†Ô∏è Not enough coins! You need ${price - userData.coins} more.`, 'warning');
        }
      }
    }
    
    function activateBoost(boostId, duration) {
      const expiresAt = Date.now() + (duration * 1000);
      userData.activeBoosts[boostId] = expiresAt;
      
      const item = storeProducts.find(p => p.id === boostId);
      const minutes = Math.floor(duration / 60);
      
      displayMessage(`‚ö° ${item.name} active for ${minutes} minutes!`, 'info');
      
      setTimeout(() => {
        delete userData.activeBoosts[boostId];
        displayMessage(`ÔøΩÔøΩÔøΩ ${item.name} has expired!`, 'info');
      }, duration * 1000);
    }
    
    function applyTheme(themeId) {
      userData.activeTheme = themeId;
      const body = document.body;
      
      body.className = body.className.replace(/theme-\w+/g, '');
      
      if (themeId === 'rainbow-theme') {
        body.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #feca57 25%, #48dbfb 50%, #1dd1a1 75%, #ee5a6f 100%)';
        displayMessage('üåà Rainbow theme activated!', 'success');
      } else if (themeId === 'gold-theme') {
        body.style.background = 'linear-gradient(135deg, #f7b733 0%, #fc4a1a 100%)';
        displayMessage('‚ú® Gold theme activated!', 'success');
      } else if (themeId === 'neon-theme') {
        body.style.background = 'linear-gradient(135deg, #00f2fe 0%, #4facfe 50%, #8e54e9 100%)';
        displayMessage('üîÆ Neon theme activated!', 'success');
      }
    }
    
    function applyBadge(badgeId) {
      userData.activeBadge = badgeId;
      const item = storeProducts.find(p => p.id === badgeId);
      
      const profileDetails = document.querySelector('.profile-details');
      let badgeElement = document.getElementById('profile-badge');
      
      if (!badgeElement) {
        badgeElement = document.createElement('span');
        badgeElement.id = 'profile-badge';
        badgeElement.style.marginLeft = '8px';
        badgeElement.style.fontSize = '20px';
        document.getElementById('profile-name').appendChild(badgeElement);
      }
      
      badgeElement.textContent = item.icon;
      displayMessage(`${item.icon} Badge equipped!`, 'success');
    }
    
    function useUnlockLevel() {
      const nextLockedLevel = levelData.find(l => l.locked);
      
      if (nextLockedLevel) {
        nextLockedLevel.locked = false;
        userData.consumables['unlock-level']--;
        if (userData.consumables['unlock-level'] <= 0) {
          delete userData.consumables['unlock-level'];
        }
        populateLevels();
        displayMessage(`üîì ${nextLockedLevel.name} unlocked!`, 'success');
      } else {
        displayMessage(`‚ÑπÔ∏è All levels are already unlocked!`, 'info');
        userData.consumables['unlock-level'] = (userData.consumables['unlock-level'] || 0) + 1;
      }
    }
    
    function getActiveXPMultiplier() {
      let multiplier = 1;
      if (userData.activeBoosts['double-xp'] && userData.activeBoosts['double-xp'] > Date.now()) {
        multiplier = 2;
      }
      if (userData.activeBoosts['triple-xp'] && userData.activeBoosts['triple-xp'] > Date.now()) {
        multiplier = 3;
      }
      return multiplier;
    }
    
    function getActiveCoinMultiplier() {
      let multiplier = 1;
      if (userData.activeBoosts['coin-multiplier'] && userData.activeBoosts['coin-multiplier'] > Date.now()) {
        multiplier = 1.5;
      }
      if (userData.activeBoosts['mega-coins'] && userData.activeBoosts['mega-coins'] > Date.now()) {
        multiplier = 2;
      }
      return multiplier;
    }

    function populateTrophies() {
      const container = document.getElementById('trophy-container');
      const unlocked = trophyData.filter(t => t.unlocked).length;
      
      document.getElementById('unlocked-count').textContent = unlocked;
      document.getElementById('total-count').textContent = trophyData.length;
      
      container.innerHTML = trophyData.map(trophy => `
        <div class="trophy-item ${trophy.unlocked ? 'earned' : 'unearned'}">
          <div class="trophy-emoji">${trophy.icon}</div>
          <div class="trophy-name">${trophy.name}</div>
          <div class="trophy-details">${trophy.desc}</div>
          ${trophy.unlocked ? '<div style="position: absolute; top: 8px; right: 8px; font-size: 24px; color: #fbbf24;">‚úì</div>' : '<div style="position: absolute; top: 8px; right: 8px; font-size: 24px;">üîí</div>'}
        </div>
      `).join('');
    }

    function performLogout() {
      const confirmDialog = document.createElement('div');
      confirmDialog.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 2999; display: flex; align-items: center; justify-content: center; padding: 20px;">
          <div style="background: white; padding: 32px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); text-align: center; max-width: 400px; width: 100%;">
            <h3 style="margin-top: 0; font-size: 24px; font-weight: 900;">Confirm Logout</h3>
            <p style="color: #64748b; margin-bottom: 24px;">Are you sure you want to logout?</p>
            <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
              <button class="action-btn btn-alt" onclick="this.closest('div[style*=fixed]').remove()">Cancel</button>
              <button class="action-btn btn-main" onclick="executeLogout()">Logout</button>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(confirmDialog);
    }

    function executeLogout() {
      document.querySelector('[style*="position: fixed"][style*="z-index: 2999"]').remove();
      document.getElementById('dashboard-app').classList.add('hide-element');
      document.getElementById('auth-screen').classList.remove('hide-element');
      displayMessage('üëã Logged out successfully', 'info');
    }

    function navigateTo(sectionId) {
      document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('showing');
      });
      
      const targetSection = document.getElementById(sectionId + '-section');
      if (targetSection) {
        targetSection.classList.add('showing');
      }
      
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('current');
      });
      
      const activeNav = userData.role === 'teacher' ? 'teacher-navigation' : 'student-navigation';
      
      const navButtons = document.getElementById(activeNav).querySelectorAll('.nav-item');
      navButtons.forEach(btn => {
        if (btn.textContent.toLowerCase().includes(sectionId.replace('teacher-', '').split('-')[0])) {
          btn.classList.add('current');
        }
      });
    }

    function displayMessage(message, type) {
      const toast = document.createElement('div');
      toast.className = `notification-toast toast-${type}-style`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    function createGroup(event) {
      event.preventDefault();
      
      const groupName = document.getElementById('group-name').value.trim();
      const groupDescription = document.getElementById('group-description').value.trim();
      
      if (!groupName) {
        displayMessage('‚ö†Ô∏è Please enter a group name', 'warning');
        return;
      }
      
      const newGroup = {
        id: groupIdCounter++,
        name: groupName,
        description: groupDescription,
        students: [],
        createdAt: new Date().toISOString()
      };
      
      teacherGroups.push(newGroup);
      
      document.getElementById('group-name').value = '';
      document.getElementById('group-description').value = '';
      
      refreshGroupsList();
      updateGroupDropdown();
      
      displayMessage(`‚úÖ Group "${groupName}" created successfully!`, 'success');
    }

    function refreshGroupsList() {
      const container = document.getElementById('groups-container');
      
      if (teacherGroups.length === 0) {
        container.innerHTML = '<p style="color: #94a3b8; text-align: center; padding: 40px;">No groups yet. Create your first group above!</p>';
        return;
      }
      
      container.innerHTML = teacherGroups.map(group => `
        <div style="border: 2px solid #e2e8f0; border-radius: 16px; padding: 24px; margin-bottom: 16px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(240, 147, 251, 0.05));">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
            <div style="flex: 1;">
              <h4 style="margin: 0 0 8px 0; font-size: 20px; font-weight: 900; color: #667eea;">üìÅ ${group.name}</h4>
              ${group.description ? `<p style="margin: 0 0 12px 0; color: #64748b; font-size: 14px;">${group.description}</p>` : ''}
              <div style="font-size: 14px; color: #94a3b8;">
                <span style="font-weight: 700;">${group.students.length}</span> student${group.students.length !== 1 ? 's' : ''}
              </div>
            </div>
            <button class="action-btn" onclick="deleteGroup(${group.id})" style="background: #ef4444; color: white; padding: 10px 20px; font-size: 14px;">Delete</button>
          </div>
          
          ${group.students.length > 0 ? `
            <div style="border-top: 2px solid #e2e8f0; padding-top: 16px; margin-top: 16px;">
              <div style="font-weight: 800; margin-bottom: 12px; font-size: 14px; color: #64748b;">STUDENTS IN GROUP:</div>
              <div style="display: grid; gap: 12px;">
                ${group.students.map(student => `
                  <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                    <div>
                      <div style="font-weight: 800; font-size: 15px; color: #1a202c;">${student.name}</div>
                      <div style="font-size: 13px; color: #94a3b8;">${student.email}</div>
                    </div>
                    <button onclick="removeStudentFromGroup(${group.id}, '${student.email}')" style="background: none; border: none; cursor: pointer; color: #ef4444; font-size: 20px; padding: 8px; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.2)'" onmouseout="this.style.transform='scale(1)'">‚úï</button>
                  </div>
                `).join('')}
              </div>
            </div>
          ` : ''}
        </div>
      `).join('');
    }

    function updateGroupDropdown() {
      const dropdown = document.getElementById('select-group');
      
      dropdown.innerHTML = '<option value="">Choose a group...</option>' + 
        teacherGroups.map(group => `
          <option value="${group.id}">${group.name} (${group.students.length} student${group.students.length !== 1 ? 's' : ''})</option>
        `).join('');
    }

    function addStudentToGroup(event) {
      event.preventDefault();
      
      const studentName = document.getElementById('student-name').value.trim();
      const studentEmail = document.getElementById('student-email').value.trim();
      const groupId = parseInt(document.getElementById('select-group').value);
      
      if (!studentName || !studentEmail || !groupId) {
        displayMessage('‚ö†Ô∏è Please fill in all fields', 'warning');
        return;
      }
      
      const group = teacherGroups.find(g => g.id === groupId);
      
      if (!group) {
        displayMessage('‚ö†Ô∏è Group not found', 'warning');
        return;
      }
      
      if (group.students.some(s => s.email === studentEmail)) {
        displayMessage('‚ö†Ô∏è Student already exists in this group', 'warning');
        return;
      }
      
      const newStudent = {
        name: studentName,
        email: studentEmail,
        addedAt: new Date().toISOString(),
        progress: 0,
        level: 1
      };
      
      group.students.push(newStudent);
      
      document.getElementById('student-name').value = '';
      document.getElementById('student-email').value = '';
      document.getElementById('select-group').value = '';
      
      refreshGroupsList();
      updateGroupDropdown();
      updateTeacherStats();
      
      displayMessage(`ÔøΩÔøΩ ${studentName} added to ${group.name}!`, 'success');
    }

    function removeStudentFromGroup(groupId, studentEmail) {
      const group = teacherGroups.find(g => g.id === groupId);
      
      if (!group) return;
      
      const studentIndex = group.students.findIndex(s => s.email === studentEmail);
      
      if (studentIndex === -1) return;
      
      const studentName = group.students[studentIndex].name;
      group.students.splice(studentIndex, 1);
      
      refreshGroupsList();
      updateGroupDropdown();
      updateTeacherStats();
      
      displayMessage(`‚úÖ ${studentName} removed from ${group.name}`, 'info');
    }

    function deleteGroup(groupId) {
      const group = teacherGroups.find(g => g.id === groupId);
      
      if (!group) return;
      
      const confirmDialog = document.createElement('div');
      confirmDialog.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 2999; display: flex; align-items: center; justify-content: center; padding: 20px;">
          <div style="background: white; padding: 32px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); text-align: center; max-width: 400px; width: 100%;">
            <h3 style="margin-top: 0; font-size: 24px; font-weight: 900;">Delete Group?</h3>
            <p style="color: #64748b; margin-bottom: 8px;">Are you sure you want to delete:</p>
            <p style="color: #1a202c; font-weight: 800; font-size: 18px; margin-bottom: 8px;">"${group.name}"</p>
            <p style="color: #ef4444; font-size: 14px; margin-bottom: 24px;">This will remove ${group.students.length} student${group.students.length !== 1 ? 's' : ''} from the group.</p>
            <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
              <button class="action-btn btn-alt" onclick="this.closest('div[style*=fixed]').remove()">Cancel</button>
              <button class="action-btn" onclick="confirmDeleteGroup(${groupId})" style="background: #ef4444; color: white;">Delete Group</button>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(confirmDialog);
    }

    function confirmDeleteGroup(groupId) {
      const groupIndex = teacherGroups.findIndex(g => g.id === groupId);
      
      if (groupIndex === -1) return;
      
      const groupName = teacherGroups[groupIndex].name;
      teacherGroups.splice(groupIndex, 1);
      
      document.querySelector('[style*="position: fixed"][style*="z-index: 2999"]').remove();
      
      refreshGroupsList();
      updateGroupDropdown();
      updateTeacherStats();
      
      displayMessage(`‚úÖ Group "${groupName}" deleted`, 'info');
    }

    function updateTeacherStats() {
      const totalStudents = teacherGroups.reduce((sum, group) => sum + group.students.length, 0);
      const teacherStudentCount = document.getElementById('teacher-student-count');
      
      if (teacherStudentCount) {
        teacherStudentCount.textContent = totalStudents;
      }
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a5a3dc97684b2c8',t:'MTc2NDMzNjg1Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>